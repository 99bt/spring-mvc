package com.yaowang.lansha.service.impl;import java.util.List;import java.util.Map;import javax.annotation.Resource;import com.yaowang.common.dao.PageDto;import com.yaowang.lansha.dao.LanshaGiftDao;import com.yaowang.lansha.entity.LanshaGift;import com.yaowang.lansha.service.LanshaGiftService;import com.yaowang.util.filesystem.util.FileSystemUtil;import com.yaowang.util.filesystem.util.FileUtil;import com.yaowang.util.filesystem.util.StorePathUtil;import org.apache.commons.lang.StringUtils;import org.springframework.stereotype.Service;/** * 礼物  * @author  *  */@Service("lanshaGiftService")public class LanshaGiftServiceImpl implements LanshaGiftService{	@Resource	private LanshaGiftDao lanshaGiftDao;		@Override	public LanshaGift save(LanshaGift entity){		return lanshaGiftDao.save(entity);	}		@Override	public Integer delete(String[] ids){		return lanshaGiftDao.delete(ids);	}		@Override	public Integer update(LanshaGift entity){		return lanshaGiftDao.update(entity);	}		@Override	public LanshaGift getLanshaGiftById(String id){		return lanshaGiftDao.getLanshaGiftById(id);	}		@Override	public Map<String, LanshaGift> getLanshaGiftMapByIds(String[] ids){		return lanshaGiftDao.getLanshaGiftMapByIds(ids);	}		@Override	public List<LanshaGift> getLanshaGiftList(LanshaGift entity){		return lanshaGiftDao.getLanshaGiftList(entity);	}		@Override	public List<LanshaGift> getLanshaGiftPage(LanshaGift entity, PageDto page){		return lanshaGiftDao.getLanshaGiftPage(entity, page);	}	@Override	public void saveImgFile(LanshaGift entity, String uploadPath)			throws Exception {		if(StringUtils.isNotBlank(entity.getImg())){			//去掉uploadPath			String headpic = entity.getImg();						if(headpic.contains(uploadPath) || headpic.contains(uploadPath.replace("/", "\\"))){				int index = headpic.indexOf(uploadPath);				if(index < 0){					index = headpic.indexOf(uploadPath.replace("/", "\\"));				}				headpic = headpic.substring(index+uploadPath.length());			}						//原图			String ext = FileUtil.getExtensionName(headpic);			String destPath = StorePathUtil.buildPath(entity.getId(), "gift", "headpic." + ext).toString();			FileSystemUtil.copyTempFile(headpic, destPath);			//删除原有文件			FileSystemUtil.deleteFile(headpic);			entity.setImg(destPath);		}			}	}